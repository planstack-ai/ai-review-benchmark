{
  "case_id": "logic_bug_17",
  "category": "logic_bug",
  "difficulty": "medium",
  "expected_detection": true,
  "bug_description": "XSS（クロスサイトスクリプティング）脆弱性。ユーザー入力をエスケープせずに html_safe でマークしている。<script>タグが実行される。",
  "bug_location": "impl.rb:12",
  "correct_implementation": "ERB::Util.html_escape(@comment.body).gsub(\"\\n\", \"<br>\").html_safe",
  "tags": ["xss", "security", "html_escape", "html_safe"],
  "notes": "html_safe は「このHTMLは安全です」というマーク。ユーザー入力には使用前に必ずエスケープが必要。"
}
