{
  "case_id": "logic_bug_19",
  "category": "logic_bug",
  "difficulty": "medium",
  "expected_detection": true,
  "bug_description": "オープンリダイレクト脆弱性。ユーザー入力 params[:return_to] を検証せずにリダイレクト先として使用。フィッシング攻撃に悪用される。",
  "bug_location": "impl.rb:13",
  "correct_implementation": "redirect_to safe_redirect_path(params[:return_to]) || root_path",
  "tags": ["open_redirect", "security", "phishing"],
  "notes": "ログイン後のリダイレクトは攻撃者に悪用されやすい。URLのホスト部分を検証するか、パスのみを使用すべき。"
}
