{
  "case_id": "plan_mismatch_03",
  "category": "plan_mismatch",
  "difficulty": "medium",
  "expected_detection": true,
  "bug_description": "1.month.from_nowを使用しているが、Planでは「30日以内」と明記されている。1ヶ月は28-31日で変動するため、30.days.from_nowを使うべき。また、既存のexpires_within?メソッドを使用していない。",
  "bug_location": "impl.rb:16",
  "correct_implementation": "Subscription.where(notified_at: nil).select { |s| s.expires_within?(30) }",
  "tags": ["date", "calculation", "month_vs_days"],
  "notes": "1.monthと30.daysの違いは微妙だが、Planで明確に30日と指定されている場合は仕様違反。"
}
