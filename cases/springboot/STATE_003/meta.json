{
  "case_id": "STATE_003",
  "category": "state",
  "axis": "spec_alignment",
  "name": "check_then_act_race",
  "difficulty": "hard",
  "expected_detection": true,
  "bug_description": "Check-then-act race condition between stock check and reservation",
  "bug_anchor": "if (stock.getQuantity() >= quantity) { stock.setQuantity(stock.getQuantity() - quantity); }",
  "correct_implementation": "stockRepository.decrementIfAvailable(productId, quantity)",
  "severity": "critical",
  "tags": [
    "state",
    "concurrency",
    "stock"
  ],
  "framework": "springboot",
  "framework_version": "3.2+",
  "java_version": "21+",
  "bug_anchor_verified": true
}
